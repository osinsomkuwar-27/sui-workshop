{"ast":null,"code":"var __typeError = msg => {\n  throw TypeError(msg);\n};\nvar __accessCheck = (obj, member, msg) => member.has(obj) || __typeError(\"Cannot \" + msg);\nvar __privateGet = (obj, member, getter) => (__accessCheck(obj, member, \"read from private field\"), getter ? getter.call(obj) : member.get(obj));\nvar __privateAdd = (obj, member, value) => member.has(obj) ? __typeError(\"Cannot add the same private member more than once\") : member instanceof WeakSet ? member.add(obj) : member.set(obj, value);\nvar __privateSet = (obj, member, value, setter) => (__accessCheck(obj, member, \"write to private field\"), setter ? setter.call(obj, value) : member.set(obj, value), value);\nvar __privateMethod = (obj, member, method) => (__accessCheck(obj, member, \"access private method\"), method);\nvar _requestId, _options, _websocketClient, _SuiHTTPTransport_instances, getWebsocketClient_fn;\nimport { PACKAGE_VERSION, TARGETED_RPC_VERSION } from \"../version.js\";\nimport { JsonRpcError, SuiHTTPStatusError } from \"./errors.js\";\nimport { WebsocketClient } from \"./rpc-websocket-client.js\";\nclass SuiHTTPTransport {\n  constructor(options) {\n    __privateAdd(this, _SuiHTTPTransport_instances);\n    __privateAdd(this, _requestId, 0);\n    __privateAdd(this, _options);\n    __privateAdd(this, _websocketClient);\n    __privateSet(this, _options, options);\n  }\n  fetch(input, init) {\n    const fetchFn = __privateGet(this, _options).fetch ?? fetch;\n    if (!fetchFn) {\n      throw new Error(\"The current environment does not support fetch, you can provide a fetch implementation in the options for SuiHTTPTransport.\");\n    }\n    return fetchFn(input, init);\n  }\n  async request(input) {\n    __privateSet(this, _requestId, __privateGet(this, _requestId) + 1);\n    const res = await this.fetch(__privateGet(this, _options).rpc?.url ?? __privateGet(this, _options).url, {\n      method: \"POST\",\n      headers: {\n        \"Content-Type\": \"application/json\",\n        \"Client-Sdk-Type\": \"typescript\",\n        \"Client-Sdk-Version\": PACKAGE_VERSION,\n        \"Client-Target-Api-Version\": TARGETED_RPC_VERSION,\n        \"Client-Request-Method\": input.method,\n        ...__privateGet(this, _options).rpc?.headers\n      },\n      body: JSON.stringify({\n        jsonrpc: \"2.0\",\n        id: __privateGet(this, _requestId),\n        method: input.method,\n        params: input.params\n      })\n    });\n    if (!res.ok) {\n      throw new SuiHTTPStatusError(`Unexpected status code: ${res.status}`, res.status, res.statusText);\n    }\n    const data = await res.json();\n    if (\"error\" in data && data.error != null) {\n      throw new JsonRpcError(data.error.message, data.error.code);\n    }\n    return data.result;\n  }\n  async subscribe(input) {\n    const unsubscribe = await __privateMethod(this, _SuiHTTPTransport_instances, getWebsocketClient_fn).call(this).subscribe(input);\n    return async () => !!(await unsubscribe());\n  }\n}\n_requestId = new WeakMap();\n_options = new WeakMap();\n_websocketClient = new WeakMap();\n_SuiHTTPTransport_instances = new WeakSet();\ngetWebsocketClient_fn = function () {\n  if (!__privateGet(this, _websocketClient)) {\n    const WebSocketConstructor = __privateGet(this, _options).WebSocketConstructor ?? WebSocket;\n    if (!WebSocketConstructor) {\n      throw new Error(\"The current environment does not support WebSocket, you can provide a WebSocketConstructor in the options for SuiHTTPTransport.\");\n    }\n    __privateSet(this, _websocketClient, new WebsocketClient(__privateGet(this, _options).websocket?.url ?? __privateGet(this, _options).url, {\n      WebSocketConstructor,\n      ...__privateGet(this, _options).websocket\n    }));\n  }\n  return __privateGet(this, _websocketClient);\n};\nexport { SuiHTTPTransport };","map":{"version":3,"names":["_requestId","_options","_websocketClient","_SuiHTTPTransport_instances","getWebsocketClient_fn","PACKAGE_VERSION","TARGETED_RPC_VERSION","JsonRpcError","SuiHTTPStatusError","WebsocketClient","SuiHTTPTransport","constructor","options","__privateAdd","__privateSet","fetch","input","init","fetchFn","__privateGet","Error","request","res","rpc","url","method","headers","body","JSON","stringify","jsonrpc","id","params","ok","status","statusText","data","json","error","message","code","result","subscribe","unsubscribe","__privateMethod","call","WeakMap","WeakSet","WebSocketConstructor","WebSocket","websocket"],"sources":["C:\\Users\\hp\\OneDrive\\Desktop\\r\\sui-workshop\\node_modules\\@mysten\\sui\\src\\client\\http-transport.ts"],"sourcesContent":["// Copyright (c) Mysten Labs, Inc.\n// SPDX-License-Identifier: Apache-2.0\n\nimport { PACKAGE_VERSION, TARGETED_RPC_VERSION } from '../version.js';\nimport { JsonRpcError, SuiHTTPStatusError } from './errors.js';\nimport type { WebsocketClientOptions } from './rpc-websocket-client.js';\nimport { WebsocketClient } from './rpc-websocket-client.js';\n\n/**\n * An object defining headers to be passed to the RPC server\n */\nexport type HttpHeaders = { [header: string]: string };\n\nexport interface SuiHTTPTransportOptions {\n\tfetch?: typeof fetch;\n\tWebSocketConstructor?: typeof WebSocket;\n\turl: string;\n\trpc?: {\n\t\theaders?: HttpHeaders;\n\t\turl?: string;\n\t};\n\twebsocket?: WebsocketClientOptions & {\n\t\turl?: string;\n\t};\n}\n\nexport interface SuiTransportRequestOptions {\n\tmethod: string;\n\tparams: unknown[];\n}\n\n// eslint-disable-next-line @typescript-eslint/ban-types\n\nexport interface SuiTransportSubscribeOptions<T> {\n\tmethod: string;\n\tunsubscribe: string;\n\tparams: unknown[];\n\tonMessage: (event: T) => void;\n}\n\nexport interface SuiTransport {\n\trequest<T = unknown>(input: SuiTransportRequestOptions): Promise<T>;\n\tsubscribe<T = unknown>(input: SuiTransportSubscribeOptions<T>): Promise<() => Promise<boolean>>;\n}\n\nexport class SuiHTTPTransport implements SuiTransport {\n\t#requestId = 0;\n\t#options: SuiHTTPTransportOptions;\n\t#websocketClient?: WebsocketClient;\n\n\tconstructor(options: SuiHTTPTransportOptions) {\n\t\tthis.#options = options;\n\t}\n\n\tfetch(input: RequestInfo, init?: RequestInit): Promise<Response> {\n\t\tconst fetchFn = this.#options.fetch ?? fetch;\n\n\t\tif (!fetchFn) {\n\t\t\tthrow new Error(\n\t\t\t\t'The current environment does not support fetch, you can provide a fetch implementation in the options for SuiHTTPTransport.',\n\t\t\t);\n\t\t}\n\n\t\treturn fetchFn(input, init);\n\t}\n\n\t#getWebsocketClient(): WebsocketClient {\n\t\tif (!this.#websocketClient) {\n\t\t\tconst WebSocketConstructor = this.#options.WebSocketConstructor ?? WebSocket;\n\t\t\tif (!WebSocketConstructor) {\n\t\t\t\tthrow new Error(\n\t\t\t\t\t'The current environment does not support WebSocket, you can provide a WebSocketConstructor in the options for SuiHTTPTransport.',\n\t\t\t\t);\n\t\t\t}\n\n\t\t\tthis.#websocketClient = new WebsocketClient(\n\t\t\t\tthis.#options.websocket?.url ?? this.#options.url,\n\t\t\t\t{\n\t\t\t\t\tWebSocketConstructor,\n\t\t\t\t\t...this.#options.websocket,\n\t\t\t\t},\n\t\t\t);\n\t\t}\n\n\t\treturn this.#websocketClient;\n\t}\n\n\tasync request<T>(input: SuiTransportRequestOptions): Promise<T> {\n\t\tthis.#requestId += 1;\n\n\t\tconst res = await this.fetch(this.#options.rpc?.url ?? this.#options.url, {\n\t\t\tmethod: 'POST',\n\t\t\theaders: {\n\t\t\t\t'Content-Type': 'application/json',\n\t\t\t\t'Client-Sdk-Type': 'typescript',\n\t\t\t\t'Client-Sdk-Version': PACKAGE_VERSION,\n\t\t\t\t'Client-Target-Api-Version': TARGETED_RPC_VERSION,\n\t\t\t\t'Client-Request-Method': input.method,\n\t\t\t\t...this.#options.rpc?.headers,\n\t\t\t},\n\t\t\tbody: JSON.stringify({\n\t\t\t\tjsonrpc: '2.0',\n\t\t\t\tid: this.#requestId,\n\t\t\t\tmethod: input.method,\n\t\t\t\tparams: input.params,\n\t\t\t}),\n\t\t});\n\n\t\tif (!res.ok) {\n\t\t\tthrow new SuiHTTPStatusError(\n\t\t\t\t`Unexpected status code: ${res.status}`,\n\t\t\t\tres.status,\n\t\t\t\tres.statusText,\n\t\t\t);\n\t\t}\n\n\t\tconst data = await res.json();\n\n\t\tif ('error' in data && data.error != null) {\n\t\t\tthrow new JsonRpcError(data.error.message, data.error.code);\n\t\t}\n\n\t\treturn data.result;\n\t}\n\n\tasync subscribe<T>(input: SuiTransportSubscribeOptions<T>): Promise<() => Promise<boolean>> {\n\t\tconst unsubscribe = await this.#getWebsocketClient().subscribe(input);\n\n\t\treturn async () => !!(await unsubscribe());\n\t}\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}